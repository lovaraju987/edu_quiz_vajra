{"version":3,"sources":["../../../lib/db.ts","../../../models/Admin.ts"],"sourcesContent":["import mongoose from 'mongoose';\n\nconst MONGODB_URI = process.env.MONGODB_URI;\n\n/**\n * Global is used here to maintain a cached connection across hot reloads\n * in development. This prevents connections from growing exponentially\n * during API Route usage.\n */\nlet cached = (global as any).mongoose;\n\nif (!cached) {\n    cached = (global as any).mongoose = { conn: null, promise: null };\n}\n\nasync function dbConnect() {\n    if (!MONGODB_URI) {\n        console.warn('⚠️ MONGODB_URI is missing. EduQuiz is running in MOCK MODE (localStorage fallback).');\n        return false;\n    }\n\n    if (cached.conn) {\n        return cached.conn;\n    }\n\n    if (!cached.promise) {\n        const opts = {\n            bufferCommands: false,\n        };\n\n        cached.promise = mongoose.connect(MONGODB_URI!, opts).then((mongoose) => {\n            return mongoose;\n        });\n    }\n\n    try {\n        cached.conn = await cached.promise;\n        console.log(\"✅ MongoDB Connected\");\n    } catch (e) {\n        cached.promise = null;\n        throw e;\n    }\n\n    return cached.conn;\n}\n\nexport default dbConnect;\n","import mongoose, { Schema, Document, Model } from \"mongoose\";\n\nexport interface IAdmin extends Document {\n    username: string;\n    passwordHash: string;\n    role: \"super_admin\" | \"editor\";\n    createdAt: Date;\n}\n\nconst AdminSchema: Schema<IAdmin> = new Schema(\n    {\n        username: {\n            type: String,\n            required: [true, \"Username is required\"],\n            unique: true,\n            trim: true,\n        },\n        passwordHash: {\n            type: String,\n            required: [true, \"Password hash is required\"],\n        },\n        role: {\n            type: String,\n            enum: [\"super_admin\", \"editor\"],\n            default: \"super_admin\",\n        },\n    },\n    { timestamps: true }\n);\n\n// Prevent model recompilation error in development\nconst Admin: Model<IAdmin> = mongoose.models.Admin || mongoose.model<IAdmin>(\"Admin\", AdminSchema);\n\nexport default Admin;\n"],"names":[],"mappings":"wlCAAA,IAAA,EAAA,EAAA,CAAA,CAAA,OAEA,IAAM,EAAc,QAAQ,GAAG,CAAC,WAAW,CAOvC,EAAS,EAAA,CAAA,CAAgB,GAAhB,KAAwB,CAMrC,eAAe,IACX,GAAI,CAAC,EAED,OADA,IADc,IACN,IAAI,CAAC,wFACN,EAGX,GAAI,EAAO,IAAI,CACX,CADa,MACN,EAAO,IAAI,CAGjB,EAAO,OAAO,EAAE,CAKjB,EAAO,OAAO,CAAG,EAAA,OAAQ,CAAC,OAAO,CAAC,EAJrB,CACT,UAG4C,MAH5B,CACpB,GAEsD,IAAI,CAAC,AAAC,GACjD,EACX,EAGJ,GAAI,CACA,EAAO,IAAI,CAAG,MAAM,EAAO,OAAO,CAClC,QAAQ,GAAG,CAAC,sBAChB,CAAE,MAAO,EAAG,CAER,MADA,EAAO,OAAO,CAAG,KACX,CACV,CAEA,OAAO,EAAO,IAAI,AACtB,CAjCI,AAAC,IACD,EAAS,EADA,AACA,CAAA,CAAgB,GAAhB,KAAwB,CAAG,CAAE,KAAM,KAAM,QAAS,IAAK,oBAkCrD,4BC9Cf,IAAA,EAAA,EAAA,CAAA,CAAA,OASA,IAAM,EAA8B,IAAI,EAAA,MAAM,CAC1C,CACI,SAAU,CACN,KAAM,OACN,SAAU,EAAC,EAAM,uBAAuB,CACxC,QAAQ,EACR,MAAM,CACV,EACA,aAAc,CACV,KAAM,OACN,SAAU,EAAC,EAAM,4BAA4B,AACjD,EACA,KAAM,CACF,KAAM,OACN,KAAM,CAAC,cAAe,SAAS,CAC/B,QAAS,aACb,CACJ,EACA,CAAE,YAAY,CAAK,GAIjB,EAAuB,EAAA,OAAQ,CAAC,MAAM,CAAC,KAAK,EAAI,EAAA,OAAQ,CAAC,KAAK,CAAS,QAAS,oBAEvE"}