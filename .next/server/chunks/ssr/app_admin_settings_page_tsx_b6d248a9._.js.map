{"version":3,"sources":["../../../../app/admin/settings/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport { toast } from \"sonner\";\n\nexport default function AdminSettings() {\n    const [isLoading, setIsLoading] = useState(false);\n\n    // Password Form State\n    const [passwords, setPasswords] = useState({\n        current: \"\",\n        new: \"\",\n        confirm: \"\"\n    });\n\n    // System Settings State\n    const [settings, setSettings] = useState({\n        maintenanceMode: false,\n        aiAutoScheduler: true\n    });\n    const [loadingSettings, setLoadingSettings] = useState(true);\n\n    // Fetch Settings\n    useEffect(() => {\n        const fetchSettings = async () => {\n            try {\n                const res = await fetch(\"/api/admin/settings\");\n                if (res.ok) {\n                    const data = await res.json();\n                    if (data.settings) {\n                        setSettings({\n                            maintenanceMode: data.settings.maintenanceMode,\n                            aiAutoScheduler: data.settings.aiAutoScheduler\n                        });\n                    }\n                }\n            } catch (error) {\n                console.error(\"Failed to load settings\");\n            } finally {\n                setLoadingSettings(false);\n            }\n        };\n        fetchSettings();\n    }, []);\n\n    const handlePasswordChange = async (e: React.FormEvent) => {\n        e.preventDefault();\n\n        if (passwords.new !== passwords.confirm) {\n            toast.error(\"New passwords do not match\");\n            return;\n        }\n\n        setIsLoading(true);\n        try {\n            const res = await fetch(\"/api/admin/profile\", {\n                method: \"PATCH\",\n                headers: { \"Content-Type\": \"application/json\" },\n                body: JSON.stringify({\n                    currentPassword: passwords.current,\n                    newPassword: passwords.new\n                }),\n            });\n\n            const data = await res.json();\n\n            if (res.ok) {\n                toast.success(\"Password updated successfully\");\n                setPasswords({ current: \"\", new: \"\", confirm: \"\" });\n            } else {\n                toast.error(data.error || \"Failed to update password\");\n            }\n        } catch (error) {\n            toast.error(\"Connection failed\");\n        } finally {\n            setIsLoading(false);\n        }\n    };\n\n    const toggleSetting = async (key: 'maintenanceMode' | 'aiAutoScheduler') => {\n        const newValue = !settings[key];\n        // Optimistic update\n        setSettings(prev => ({ ...prev, [key]: newValue }));\n\n        try {\n            const res = await fetch(\"/api/admin/settings\", {\n                method: \"PATCH\",\n                headers: { \"Content-Type\": \"application/json\" },\n                body: JSON.stringify({ [key]: newValue }),\n            });\n\n            if (!res.ok) {\n                // Revert if failed\n                setSettings(prev => ({ ...prev, [key]: !newValue }));\n                toast.error(\"Failed to update setting\");\n            } else {\n                toast.success(`${key === 'maintenanceMode' ? 'Maintenance Mode' : 'AI Scheduler'} ${newValue ? 'Enabled' : 'Disabled'}`);\n            }\n        } catch (error) {\n            setSettings(prev => ({ ...prev, [key]: !newValue }));\n            toast.error(\"Connection error\");\n        }\n    };\n\n    return (\n        <div className=\"space-y-8 max-w-4xl mx-auto\">\n            <h1 className=\"text-3xl font-bold text-slate-900\">Settings</h1>\n\n            {/* Password Management */}\n            <div className=\"bg-white border border-slate-200 rounded-2xl p-8 shadow-sm\">\n                <div className=\"flex items-center gap-3 mb-6\">\n                    <div className=\"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 font-bold text-xl\">\n                        üîí\n                    </div>\n                    <div>\n                        <h2 className=\"text-xl font-bold text-slate-900\">Security</h2>\n                        <p className=\"text-slate-500 text-sm\">Manage your password and account access.</p>\n                    </div>\n                </div>\n\n                <form onSubmit={handlePasswordChange} className=\"space-y-4 max-w-md\">\n                    <div>\n                        <label className=\"block text-sm font-bold text-slate-700 mb-1\">Current Password</label>\n                        <input\n                            type=\"password\"\n                            required\n                            value={passwords.current}\n                            onChange={(e) => setPasswords({ ...passwords, current: e.target.value })}\n                            className=\"w-full px-4 py-2.5 border border-slate-300 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none transition-all\"\n                            placeholder=\"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢\"\n                        />\n                    </div>\n\n                    <div className=\"grid grid-cols-2 gap-4\">\n                        <div>\n                            <label className=\"block text-sm font-bold text-slate-700 mb-1\">New Password</label>\n                            <input\n                                type=\"password\"\n                                required\n                                minLength={6}\n                                value={passwords.new}\n                                onChange={(e) => setPasswords({ ...passwords, new: e.target.value })}\n                                className=\"w-full px-4 py-2.5 border border-slate-300 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none transition-all\"\n                                placeholder=\"Min 6 chars\"\n                            />\n                        </div>\n                        <div>\n                            <label className=\"block text-sm font-bold text-slate-700 mb-1\">Confirm New</label>\n                            <input\n                                type=\"password\"\n                                required\n                                minLength={6}\n                                value={passwords.confirm}\n                                onChange={(e) => setPasswords({ ...passwords, confirm: e.target.value })}\n                                className=\"w-full px-4 py-2.5 border border-slate-300 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none transition-all\"\n                                placeholder=\"Confirm\"\n                            />\n                        </div>\n                    </div>\n\n                    <button\n                        type=\"submit\"\n                        disabled={isLoading}\n                        className=\"w-full py-3 bg-blue-600 text-white font-bold rounded-xl hover:bg-blue-700 disabled:opacity-50 transition-all shadow-lg shadow-blue-200 mt-2\"\n                    >\n                        {isLoading ? \"Updating...\" : \"Update Password\"}\n                    </button>\n                </form>\n            </div>\n\n            {/* System Preferences */}\n            <div className=\"bg-white border border-slate-200 rounded-2xl p-8 shadow-sm\">\n                <div className=\"flex items-center gap-3 mb-6\">\n                    <div className=\"w-10 h-10 rounded-full bg-slate-100 flex items-center justify-center text-slate-600 font-bold text-xl\">\n                        ‚öôÔ∏è\n                    </div>\n                    <div>\n                        <h2 className=\"text-xl font-bold text-slate-900\">System Preferences</h2>\n                        <p className=\"text-slate-500 text-sm\">Global system configuration.</p>\n                    </div>\n                </div>\n\n                {loadingSettings ? (\n                    <div className=\"p-8 text-center text-slate-400 animate-pulse\">Loading preferences...</div>\n                ) : (\n                    <div className=\"space-y-4\">\n                        <div className=\"flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-100\">\n                            <div>\n                                <h3 className=\"font-bold text-slate-800\">Maintenance Mode</h3>\n                                <p className=\"text-xs text-slate-500\">Disable access for non-admin users.</p>\n                            </div>\n                            <button\n                                onClick={() => toggleSetting('maintenanceMode')}\n                                className={`w-12 h-6 rounded-full relative transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 ${settings.maintenanceMode ? 'bg-blue-600' : 'bg-slate-300'}`}\n                            >\n                                <span className={`absolute top-1 left-1 w-4 h-4 rounded-full bg-white shadow ring-0 transition-transform duration-200 ease-in-out ${settings.maintenanceMode ? 'translate-x-6' : 'translate-x-0'}`}></span>\n                            </button>\n                        </div>\n\n                        <div className=\"flex items-center justify-between p-4 bg-slate-50 rounded-xl border border-slate-100\">\n                            <div>\n                                <h3 className=\"font-bold text-slate-800\">AI Auto-Scheduler</h3>\n                                <p className=\"text-xs text-slate-500\">Automatically generate quizzes at midnight.</p>\n                            </div>\n                            <button\n                                onClick={() => toggleSetting('aiAutoScheduler')}\n                                className={`w-12 h-6 rounded-full relative transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 ${settings.aiAutoScheduler ? 'bg-green-500' : 'bg-slate-300'}`}\n                            >\n                                <span className={`absolute top-1 left-1 w-4 h-4 rounded-full bg-white shadow ring-0 transition-transform duration-200 ease-in-out ${settings.aiAutoScheduler ? 'translate-x-6' : 'translate-x-0'}`}></span>\n                            </button>\n                        </div>\n                    </div>\n                )}\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":"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"}