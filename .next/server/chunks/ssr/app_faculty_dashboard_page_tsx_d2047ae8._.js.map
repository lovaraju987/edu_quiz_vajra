{"version":3,"sources":["../../../../app/faculty/dashboard/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect } from \"react\";\n\nexport default function DashboardOverview() {\n    const [statsData, setStatsData] = useState<any>({\n        totalStudents: 0,\n        enrolledToday: 0,\n        totalQuizResults: 0,\n        completionRate: 0,\n        recentActivities: []\n    });\n\n    const formatRelativeTime = (date: string) => {\n        const now = new Date();\n        const past = new Date(date);\n        const diffInMs = now.getTime() - past.getTime();\n        const diffInMins = Math.floor(diffInMs / (1000 * 60));\n        const diffInHours = Math.floor(diffInMins / 60);\n        const diffInDays = Math.floor(diffInHours / 24);\n\n        if (diffInMins < 1) return \"Just now\";\n        if (diffInMins < 60) return `${diffInMins}m ago`;\n        if (diffInHours < 24) return `${diffInHours}h ago`;\n        return `${diffInDays}d ago`;\n    };\n\n    const [countdown, setCountdown] = useState(\"\");\n    const [progress, setProgress] = useState(0);\n\n    const calculateCountdown = (status: string) => {\n        const now = new Date();\n        const target = new Date();\n\n        if (status === \"Opening Soon\") {\n            target.setHours(8, 0, 0, 0);\n            const diff = target.getTime() - now.getTime();\n            const hours = Math.floor(diff / (1000 * 60 * 60));\n            const mins = Math.floor((diff / (1000 * 60)) % 60);\n            return `starts in ${hours}h ${mins}m`;\n        } else if (status === \"Live\") {\n            target.setHours(20, 0, 0, 0);\n            const diff = target.getTime() - now.getTime();\n            const hours = Math.floor(diff / (1000 * 60 * 60));\n            const mins = Math.floor((diff / (1000 * 60)) % 60);\n            return `ends in ${hours}h ${mins}m`;\n        } else {\n            target.setDate(target.getDate() + 1);\n            target.setHours(8, 0, 0, 0);\n            const diff = target.getTime() - now.getTime();\n            const hours = Math.floor(diff / (1000 * 60 * 60));\n            const mins = Math.floor((diff / (1000 * 60)) % 60);\n            return `tomorrow in ${hours}h ${mins}m`;\n        }\n    };\n\n    useEffect(() => {\n        const fetchStats = async () => {\n            const session = localStorage.getItem(\"faculty_session\");\n            const faculty = session ? JSON.parse(session) : null;\n            if (faculty) {\n                const res = await fetch(`/api/faculty/stats?facultyId=${faculty.id}`);\n                const data = await res.json();\n                if (res.ok) {\n                    setStatsData(data);\n                    // Global Daily Attempts is still useful for progress, but we use participant count for \"LIVE\"\n                    const p = Math.min(Math.round((data.globalLiveParticipants / 100) * 100), 100); // 100 is a \"Live\" concurrent target\n                    setProgress(p);\n                    setCountdown(calculateCountdown(data.examStatus));\n                }\n            }\n        };\n\n        fetchStats();\n        const statsInterval = setInterval(fetchStats, 30000); // Poll every 30s for REAL-TIME feel\n\n        return () => clearInterval(statsInterval);\n    }, []);\n\n    const stats = [\n        { name: \"Total Students\", value: statsData.totalStudents, icon: \"üë•\", change: \"Live\", color: \"text-blue-600 bg-blue-50\" },\n        { name: \"Enrolled Today\", value: statsData.enrolledToday, icon: \"üìù\", change: \"Daily\", color: \"text-green-600 bg-green-50\" },\n        { name: \"Quiz Completion\", value: `${statsData.completionRate}%`, icon: \"‚úÖ\", change: \"Total\", color: \"text-purple-600 bg-purple-50\" },\n        {\n            name: \"Daily Top 100\",\n            value: statsData.examStatus === 'Closed' ? 'Calculating...' : 'Active',\n            icon: \"üèÜ\",\n            change: statsData.examStatus === 'Live' ? \"Closes 8PM\" : \"8:00 PM\",\n            color: \"text-amber-600 bg-amber-50\"\n        },\n    ];\n\n    return (\n        <div className=\"space-y-8\">\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6\">\n                {stats.map((stat) => (\n                    <div key={stat.name} className=\"p-6 bg-white rounded-3xl border border-slate-100 shadow-sm hover:shadow-md transition-shadow\">\n                        <div className=\"flex items-center justify-between mb-4\">\n                            <div className={`w-12 h-12 rounded-2xl flex items-center justify-center text-2xl ${stat.color}`}>\n                                {stat.icon}\n                            </div>\n                            <span className={`text-xs font-bold px-2 py-1 rounded-full ${stat.name === 'Daily Top 100' ? 'bg-amber-100 text-amber-700' : 'bg-green-100 text-green-700'}`}>\n                                {stat.change}\n                            </span>\n                        </div>\n                        <h3 className=\"text-slate-500 text-sm font-semibold uppercase tracking-wider\">{stat.name}</h3>\n                        <p className=\"text-3xl font-extrabold text-slate-900 mt-1\">{stat.value}</p>\n                    </div>\n                ))}\n            </div>\n\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8\">\n                <div className=\"bg-white p-8 rounded-3xl border border-slate-100 shadow-sm\">\n                    <h3 className=\"text-xl font-bold text-slate-900 mb-6\">Recent Activity</h3>\n                    <div className=\"space-y-6\">\n                        {statsData.recentActivities?.length > 0 ? (\n                            statsData.recentActivities.map((activity: any, i: number) => (\n                                <div key={i} className=\"flex gap-4 items-start pb-6 border-b border-slate-50 last:border-0 last:pb-0\">\n                                    <div className={`w-10 h-10 rounded-full flex items-center justify-center font-bold ${activity.type === 'registration' ? 'bg-blue-50 text-blue-500' : 'bg-green-50 text-green-500'}`}>\n                                        {activity.type === 'registration' ? 'üë§' : 'üéØ'}\n                                    </div>\n                                    <div>\n                                        <p className=\"text-sm font-bold text-slate-800\">{activity.title}</p>\n                                        <p className=\"text-xs text-slate-500 mt-1\">\n                                            {formatRelativeTime(activity.date)} ‚Ä¢ {activity.subtitle}\n                                        </p>\n                                    </div>\n                                </div>\n                            ))\n                        ) : (\n                            <div className=\"text-center py-10\">\n                                <p className=\"text-slate-400 text-sm italic\">No recent activity found.</p>\n                            </div>\n                        )}\n                    </div>\n                </div>\n\n                <div className=\"bg-blue-900 text-white p-8 rounded-3xl shadow-xl border border-blue-800 overflow-hidden relative\">\n                    <div className=\"absolute top-0 right-0 p-4 opacity-10\">\n                        <div className=\"text-9xl font-black rotate-12\">8:30</div>\n                    </div>\n                    <h3 className=\"text-xl font-bold mb-2\">Daily Live Quiz Pulse</h3>\n                    <p className=\"text-blue-200 text-sm mb-8\">\n                        {statsData.examStatus === 'Live' ? 'The exam is currently LIVE.' :\n                            statsData.examStatus === 'Opening Soon' ? 'The exam window opens soon.' :\n                                'The exam window is now closed.'} Next session {countdown}.\n                    </p>\n\n                    <div className=\"space-y-4 relative z-10\">\n                        <div className=\"flex justify-between items-center py-2\">\n                            <span className=\"text-blue-300\">Live Participants</span>\n                            <span className=\"font-bold\">{statsData.globalLiveParticipants || 0}</span>\n                        </div>\n                        <div className=\"w-full h-2 bg-blue-800 rounded-full overflow-hidden\">\n                            <div className=\"h-full bg-yellow-400 transition-all duration-1000\" style={{ width: `${progress}%` }} />\n                        </div>\n                        <p className=\"text-xs text-blue-300 italic\">Tracking real-time student activity</p>\n                    </div>\n                </div>\n            </div>\n\n        </div>\n    );\n}\n"],"names":[],"mappings":"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"}