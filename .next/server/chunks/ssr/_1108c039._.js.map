{"version":3,"sources":["../../../../app/faculty/dashboard/profile/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect } from \"react\";\n\nexport default function FacultyProfile() {\n    const [isProfileSet, setIsProfileSet] = useState(false);\n    const [loading, setLoading] = useState(true);\n    const [profileData, setProfileData] = useState({\n        schoolName: \"\",\n        schoolBoard: \"CBSE\",\n        uniqueId: \"\",\n        designation: \"\",\n        phone: \"\",\n        address: \"\"\n    });\n    const [faculty, setFaculty] = useState<any>(null);\n\n    useEffect(() => {\n        const fetchProfile = async () => {\n            const session = localStorage.getItem(\"faculty_session\");\n            const sessionData = session ? JSON.parse(session) : null;\n            if (sessionData) {\n                setFaculty(sessionData);\n                try {\n                    const res = await fetch(`/api/faculty/profile?facultyId=${sessionData.id}`);\n                    const data = await res.json();\n                    if (res.ok && data.isProfileActive) {\n                        setProfileData({\n                            schoolName: data.schoolName,\n                            schoolBoard: data.schoolBoard,\n                            uniqueId: data.uniqueId,\n                            designation: data.designation || \"\",\n                            phone: data.phone || \"\",\n                            address: data.address || \"\"\n                        });\n                        setIsProfileSet(true);\n                    }\n                } catch (error) {\n                    console.error(\"Failed to fetch profile\", error);\n                }\n            }\n            setLoading(false);\n        };\n        fetchProfile();\n    }, []);\n\n    const handleSaveProfile = async (e: React.FormEvent) => {\n        e.preventDefault();\n        if (profileData.uniqueId.length < 2) {\n            import('sonner').then(({ toast }) => toast.error(\"Unique ID must be at least 2 letters.\"));\n            return;\n        }\n\n        try {\n            const res = await fetch('/api/faculty/profile', {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({\n                    facultyId: faculty.id,\n                    ...profileData\n                })\n            });\n\n            const data = await res.json();\n            if (res.ok) {\n                // Update session with new faculty details\n                const updatedSession = { ...faculty, ...data.faculty };\n                localStorage.setItem(\"faculty_session\", JSON.stringify(updatedSession));\n                setIsProfileSet(true);\n                import('sonner').then(({ toast }) => toast.success(\"School Profile Activated Successfully!\"));\n            } else {\n                import('sonner').then(({ toast }) => toast.error(data.error || \"Failed to save profile\"));\n            }\n        } catch (error) {\n            import('sonner').then(({ toast }) => toast.error(\"Connection error.\"));\n        }\n    };\n\n    if (loading) return <div className=\"p-10 text-center font-bold text-slate-400\">Loading profile...</div>;\n\n    return (\n        <div className=\"space-y-8 max-w-5xl mx-auto\">\n            {/* Faculty Details Card */}\n            <div className=\"bg-[#002e5d] text-white p-8 rounded-[40px] shadow-2xl relative overflow-hidden\">\n                <div className=\"absolute top-0 right-0 p-8 opacity-10\">\n                    <div className=\"text-9xl font-black rotate-12\">PROF</div>\n                </div>\n                <div className=\"relative z-10 flex items-center gap-8\">\n                    <div className=\"w-24 h-24 rounded-full bg-blue-700 border-4 border-white/20 flex items-center justify-center text-4xl shadow-inner font-black uppercase\">\n                        {faculty?.name?.split(' ').map((n: string) => n[0]).join('').slice(0, 2) || \"FA\"}\n                    </div>\n                    <div>\n                        <h2 className=\"text-3xl font-black tracking-tight\">{faculty?.name || \"Faculty Member\"}</h2>\n                        <p className=\"text-blue-200 font-bold uppercase tracking-[0.2em] text-xs mt-1\">\n                            {isProfileSet ? `${profileData.schoolName} | ${profileData.schoolBoard}` : \"Profile Pending Activation\"}\n                        </p>\n                        <div className=\"flex gap-4 mt-4\">\n                            <span className=\"px-3 py-1 bg-white/10 rounded-full text-[10px] font-black uppercase tracking-widest border border-white/10\">ID: {faculty?.id?.slice(-6) || \"N/A\"}</span>\n                            <span className={`px-3 py-1 rounded-full text-[10px] font-black uppercase tracking-widest border ${isProfileSet ? 'bg-green-500/20 text-green-300 border-green-500/20' : 'bg-amber-500/20 text-amber-300 border-amber-500/20'}`}>\n                                {isProfileSet ? 'Verified' : 'Pending Activation'}\n                            </span>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            {/* Profile Data Display / Form */}\n            <div className=\"bg-white p-10 rounded-[40px] border border-slate-100 shadow-xl shadow-blue-50/50\">\n                <div className=\"flex items-center justify-between mb-8\">\n                    <h3 className=\"text-2xl font-black text-slate-900 flex items-center gap-3 tracking-tight\">\n                        <span>üè´</span> School Configuration\n                    </h3>\n\n                </div>\n\n                {isProfileSet ? (\n                    <div className=\"grid grid-cols-1 md:grid-cols-3 gap-8 p-8 bg-slate-50 rounded-3xl border border-slate-100 animate-[fadeIn_0.5s_ease-out]\">\n                        <div className=\"space-y-1\">\n                            <p className=\"text-[10px] font-black text-slate-400 uppercase tracking-widest\">Active School</p>\n                            <p className=\"text-lg font-black text-slate-800\">{profileData.schoolName}</p>\n                        </div>\n                        <div className=\"space-y-1\">\n                            <p className=\"text-[10px] font-black text-slate-400 uppercase tracking-widest\">Board Affiliation</p>\n                            <p className=\"text-lg font-black text-slate-800\">{profileData.schoolBoard}</p>\n                        </div>\n                        <div className=\"space-y-1\">\n                            <p className=\"text-[10px] font-black text-slate-400 uppercase tracking-widest\">Student ID Prefix</p>\n                            <div className=\"flex items-center gap-2\">\n                                <span className=\"px-3 py-1 bg-[#002e5d] text-white rounded-lg font-mono font-black text-lg shadow-md\">{profileData.uniqueId}</span>\n                                <span className=\"text-xs text-slate-400 font-bold italic\">e.g. {profileData.uniqueId}-1001</span>\n                            </div>\n                        </div>\n                    </div>\n                ) : (\n                    <form onSubmit={handleSaveProfile} className=\"grid grid-cols-1 md:grid-cols-3 gap-8\">\n                        <div className=\"space-y-2\">\n                            <label className=\"text-[10px] font-black text-slate-500 uppercase tracking-widest ml-1\">School Name</label>\n                            <input\n                                type=\"text\"\n                                required\n                                value={profileData.schoolName}\n                                onChange={(e) => setProfileData({ ...profileData, schoolName: e.target.value })}\n                                className=\"w-full px-6 py-4 bg-slate-50 border-2 border-slate-100 rounded-2xl focus:ring-4 focus:ring-blue-100 focus:border-[#002e5d] outline-none transition-all font-bold text-slate-800\"\n                                placeholder=\"e.g. Vajra International School\"\n                            />\n                        </div>\n                        <div className=\"space-y-2\">\n                            <label className=\"text-[10px] font-black text-slate-500 uppercase tracking-widest ml-1\">School Board</label>\n                            <select\n                                value={profileData.schoolBoard}\n                                onChange={(e) => setProfileData({ ...profileData, schoolBoard: e.target.value })}\n                                className=\"w-full px-6 py-4 bg-slate-50 border-2 border-slate-100 rounded-2xl focus:ring-4 focus:ring-blue-100 focus:border-[#002e5d] outline-none transition-all font-black text-slate-700\"\n                            >\n                                <option>CBSE</option>\n                                <option>ICSE</option>\n                                <option>State Board</option>\n                                <option>IB</option>\n                            </select>\n                        </div>\n                        <div className=\"space-y-2\">\n                            <label className=\"text-[10px] font-black text-slate-500 uppercase tracking-widest ml-1\">Unique ID (Min 2 letters)</label>\n                            <input\n                                type=\"text\"\n                                maxLength={5}\n                                required\n                                value={profileData.uniqueId}\n                                onChange={(e) => {\n                                    const val = e.target.value.toUpperCase();\n                                    const usedIds = ['AB', 'XY', 'EQ']; // Mock used IDs\n                                    if (val.length >= 2 && usedIds.includes(val)) {\n                                        e.target.setCustomValidity('This ID is already in use. Please choose another.');\n                                    } else {\n                                        e.target.setCustomValidity('');\n                                    }\n                                    setProfileData({ ...profileData, uniqueId: val });\n                                }}\n                                className=\"w-full px-6 py-4 bg-slate-50 border-2 border-slate-100 rounded-2xl focus:ring-4 focus:ring-blue-100 focus:border-[#002e5d] outline-none transition-all font-mono font-black uppercase text-slate-800\"\n                                placeholder=\"e.g. VG\"\n                            />\n                        </div>\n\n                        <div className=\"space-y-2\">\n                            <label className=\"text-[10px] font-black text-slate-500 uppercase tracking-widest ml-1\">Designation</label>\n                            <input type=\"text\" value={profileData.designation} onChange={(e) => setProfileData({ ...profileData, designation: e.target.value })} className=\"w-full px-6 py-4 bg-slate-50 border-2 border-slate-100 rounded-2xl focus:ring-4 focus:ring-blue-100 outline-none font-bold text-slate-800\" placeholder=\"e.g. Principal\" />\n                        </div>\n                        <div className=\"space-y-2\">\n                            <label className=\"text-[10px] font-black text-slate-500 uppercase tracking-widest ml-1\">Phone Number</label>\n                            <input type=\"tel\" value={profileData.phone} onChange={(e) => setProfileData({ ...profileData, phone: e.target.value })} className=\"w-full px-6 py-4 bg-slate-50 border-2 border-slate-100 rounded-2xl focus:ring-4 focus:ring-blue-100 outline-none font-bold text-slate-800\" placeholder=\"e.g. 9876543210\" />\n                        </div>\n                        <div className=\"md:col-span-3 space-y-2\">\n                            <label className=\"text-[10px] font-black text-slate-500 uppercase tracking-widest ml-1\">School Address</label>\n                            <input type=\"text\" value={profileData.address} onChange={(e) => setProfileData({ ...profileData, address: e.target.value })} className=\"w-full px-6 py-4 bg-slate-50 border-2 border-slate-100 rounded-2xl focus:ring-4 focus:ring-blue-100 outline-none font-bold text-slate-800\" placeholder=\"e.g. 123 Education Lane, Hyderabad\" />\n                        </div>\n                        <div className=\"md:col-span-3 flex justify-end pt-4\">\n                            <button\n                                type=\"submit\"\n                                className=\"px-12 py-4 bg-[#002e5d] text-white font-black rounded-2xl hover:bg-[#003d7a] transition-all shadow-[0_10px_20px_rgba(0,46,93,0.2)] active:scale-95 uppercase tracking-widest text-xs\"\n                            >\n                                Activate School Profile\n                            </button>\n                        </div>\n                    </form>\n                )}\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":"wDAEA,EAAA,EAAA,CAAA,CAAA,OAEe,SAAS,IACpB,GAAM,CAAC,EAAc,EAAgB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAC3C,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GACjC,CAAC,EAAa,EAAe,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,CAC3C,WAAY,GACZ,YAAa,OACb,SAAU,GACV,YAAa,GACb,MAAO,GACP,QAAS,EACb,GACM,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAM,MAE5C,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KA0BN,CAzBqB,UACjB,IAAM,EAAU,aAAa,OAAO,CAAC,mBAC/B,EAAc,EAAU,KAAK,KAAK,CAAC,GAAW,KACpD,GAAI,EAAa,CACb,EAAW,GACX,GAAI,CACA,IAAM,EAAM,MAAM,MAAM,CAAC,+BAA+B,EAAE,EAAY,EAAE,CAAA,CAAE,EACpE,EAAO,MAAM,EAAI,IAAI,GACvB,EAAI,EAAE,EAAI,EAAK,eAAe,EAAE,CAChC,EAAe,CACX,WAAY,EAAK,UAAU,CAC3B,YAAa,EAAK,WAAW,CAC7B,SAAU,EAAK,QAAQ,CACvB,YAAa,EAAK,WAAW,EAAI,GACjC,MAAO,EAAK,KAAK,EAAI,GACrB,QAAS,EAAK,OAAO,EAAI,EAC7B,GACA,GAAgB,GAExB,CAAE,MAAO,EAAO,CACZ,QAAQ,KAAK,CAAC,0BAA2B,EAC7C,CACJ,CACA,GAAW,GACf,GAEJ,EAAG,EAAE,EAEL,IAAM,EAAoB,MAAO,IAE7B,GADA,EAAE,cAAc,GACZ,EAAY,QAAQ,CAAC,MAAM,CAAG,EAAG,YACjC,EAAA,CAAA,CAAA,OAAiB,IAAI,CAAC,CAAC,OAAE,CAAK,CAAE,GAAK,EAAM,KAAK,CAAC,0CAIrD,GAAI,CACA,IAAM,EAAM,MAAM,MAAM,uBAAwB,CAC5C,OAAQ,OACR,QAAS,CAAE,eAAgB,kBAAmB,EAC9C,KAAM,KAAK,SAAS,CAAC,CACjB,UAAW,EAAQ,EAAE,CACrB,GAAG,CAAW,AAClB,EACJ,GAEM,EAAO,MAAM,EAAI,IAAI,GAC3B,GAAI,EAAI,EAAE,CAAE,CAER,IAAM,EAAiB,CAAE,GAAG,CAAO,CAAE,GAAG,EAAK,OAAO,AAAC,EACrD,aAAa,OAAO,CAAC,kBAAmB,KAAK,SAAS,CAAC,IACvD,GAAgB,GAChB,EAAA,CAAA,CAAA,OAAiB,IAAI,CAAC,CAAC,OAAE,CAAK,CAAE,GAAK,EAAM,OAAO,CAAC,0CACvD,MACI,CADG,CACH,CAAA,CAAA,OAAiB,IAAI,CAAC,CAAC,OAAE,CAAK,CAAE,GAAK,EAAM,KAAK,CAAC,EAAK,KAAK,EAAI,0BAEvE,CAAE,MAAO,EAAO,CACZ,EAAA,CAAA,CAAA,OAAiB,IAAI,CAAC,CAAC,OAAE,CAAK,CAAE,GAAK,EAAM,KAAK,CAAC,qBACrD,CACJ,SAEA,AAAI,EAAgB,CAAA,EAAA,EAAA,EAAP,CAAO,EAAC,MAAA,CAAI,UAAU,qDAA4C,uBAG3E,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wCAEX,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2FACX,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iDACX,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yCAAgC,WAEnD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,kDACX,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,mJACV,GAAS,MAAM,MAAM,KAAK,IAAI,AAAC,GAAc,CAAC,CAAC,EAAE,EAAE,KAAK,IAAI,MAAM,EAAG,IAAM,OAEhF,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,WACG,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,8CAAsC,GAAS,MAAQ,mBACrE,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,2EACR,EAAe,CAAA,EAAG,EAAY,UAAU,CAAC,GAAG,EAAE,EAAY,WAAW,CAAA,CAAE,CAAG,+BAE/E,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,4BACX,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,uHAA6G,OAAK,GAAS,IAAI,MAAM,CAAC,IAAM,SAC5J,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAW,CAAC,+EAA+E,EAAE,EAAe,qDAAuD,qDAAA,CAAsD,UAC1N,EAAe,WAAa,mCAQjD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,6FACX,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,kDACX,CAAA,EAAA,EAAA,IAAA,EAAC,KAAA,CAAG,UAAU,sFACV,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,UAAK,OAAS,6BAKtB,EACG,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,qIACX,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACX,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,2EAAkE,kBAC/E,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,6CAAqC,EAAY,UAAU,MAE5E,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACX,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,2EAAkE,sBAC/E,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,6CAAqC,EAAY,WAAW,MAE7E,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACX,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,2EAAkE,sBAC/E,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACX,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,+FAAuF,EAAY,QAAQ,GAC3H,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,oDAA0C,QAAM,EAAY,QAAQ,CAAC,oBAKjG,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,SAAU,EAAmB,UAAU,kDACzC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACX,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,gFAAuE,gBACxF,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACG,KAAK,OACL,QAAQ,CAAA,CAAA,EACR,MAAO,EAAY,UAAU,CAC7B,SAAU,AAAC,GAAM,EAAe,CAAE,GAAG,CAAW,CAAE,WAAY,EAAE,MAAM,CAAC,KAAK,AAAC,GAC7E,UAAU,kLACV,YAAY,uCAGpB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACX,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,gFAAuE,iBACxF,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,CACG,MAAO,EAAY,WAAW,CAC9B,SAAU,AAAC,GAAM,EAAe,CAAE,GAAG,CAAW,CAAE,YAAa,EAAE,MAAM,CAAC,KAAK,AAAC,GAC9E,UAAU,6LAEV,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,UAAO,SACR,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,UAAO,SACR,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,UAAO,gBACR,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,UAAO,aAGhB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACX,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,gFAAuE,8BACxF,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CACG,KAAK,OACL,UAAW,EACX,QAAQ,CAAA,CAAA,EACR,MAAO,EAAY,QAAQ,CAC3B,SAAU,AAAC,IACP,IAAM,EAAM,EAAE,MAAM,CAAC,KAAK,CAAC,WAAW,GAElC,EAAI,MAAM,EAAI,GAAK,AADP,CAAC,KAAM,KAAM,KAAK,CACH,CADK,OACG,CAAC,GACpC,EAAE,CADwC,EADM,GAExC,CAAC,iBAAiB,CAAC,qDAE3B,EAAE,MAAM,CAAC,iBAAiB,CAAC,IAE/B,EAAe,CAAE,GAAG,CAAW,CAAE,SAAU,CAAI,EACnD,EACA,UAAU,uMACV,YAAY,eAIpB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACX,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,gFAAuE,gBACxF,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,KAAK,OAAO,MAAO,EAAY,WAAW,CAAE,SAAU,AAAC,GAAM,EAAe,CAAE,GAAG,CAAW,CAAE,YAAa,EAAE,MAAM,CAAC,KAAK,AAAC,GAAI,UAAU,4IAA4I,YAAY,sBAE3S,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACX,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,gFAAuE,iBACxF,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,KAAK,MAAM,MAAO,EAAY,KAAK,CAAE,SAAU,AAAC,GAAM,EAAe,CAAE,GAAG,CAAW,CAAE,MAAO,EAAE,MAAM,CAAC,KAAK,AAAC,GAAI,UAAU,4IAA4I,YAAY,uBAE9R,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACX,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,UAAU,gFAAuE,mBACxF,CAAA,EAAA,EAAA,GAAA,EAAC,QAAA,CAAM,KAAK,OAAO,MAAO,EAAY,OAAO,CAAE,SAAU,AAAC,GAAM,EAAe,CAAE,GAAG,CAAW,CAAE,QAAS,EAAE,MAAM,CAAC,KAAK,AAAC,GAAI,UAAU,4IAA4I,YAAY,0CAEnS,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,+CACX,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACG,KAAK,SACL,UAAU,gMACb,sCAS7B"}