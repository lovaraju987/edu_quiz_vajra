{"version":3,"sources":["../../../../app/admin/quizzes/page.tsx"],"sourcesContent":["// ... imports\n\"use client\";\n\nimport { useState } from \"react\";\nimport { toast } from \"sonner\";\n\ninterface Question {\n    _id: string;\n    text: string;\n    options: string[];\n    answerIndex: number;\n    category: string;\n    createdAt: string;\n}\n\ninterface HistoryEntry {\n    _id: string; // Date string YYYY-MM-DD\n    count: number;\n}\n\nexport default function AdminQuizzes() {\n    const [viewMode, setViewMode] = useState<'none' | 'questions' | 'history'>('none');\n    const [selectedLevel, setSelectedLevel] = useState<number>(0);\n    const [selectedDate, setSelectedDate] = useState<string>(\"\");\n\n    const [questions, setQuestions] = useState<Question[]>([]);\n    const [historyList, setHistoryList] = useState<HistoryEntry[]>([]);\n    const [loading, setLoading] = useState(false);\n\n    const levels = ['Level 1 (4th-6th)', 'Level 2 (7th-8th)', 'Level 3 (9th-10th)'];\n\n    const handleViewQuestions = async (levelIndex: number) => {\n        setLoading(true);\n        setSelectedLevel(levelIndex + 1);\n        setSelectedDate(\"Today's Active Quiz\");\n        setViewMode('questions');\n\n        try {\n            const res = await fetch(`/api/admin/quiz/current?level=${levelIndex + 1}`);\n            const data = await res.json();\n            if (res.ok) {\n                setQuestions(data.questions);\n            } else {\n                toast.error(\"Failed to load questions\");\n            }\n        } catch (error) {\n            toast.error(\"Error connecting to server\");\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleViewHistory = async (levelIndex: number) => {\n        setLoading(true);\n        setSelectedLevel(levelIndex + 1);\n        setViewMode('history');\n\n        try {\n            const res = await fetch(`/api/admin/quiz/history?level=${levelIndex + 1}`);\n            const data = await res.json();\n            if (res.ok) {\n                setHistoryList(data.history);\n            } else {\n                toast.error(\"Failed to load history\");\n            }\n        } catch (error) {\n            toast.error(\"Error connecting to server\");\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleHistoryDateClick = async (date: string) => {\n        setLoading(true);\n        setSelectedDate(date);\n        setViewMode('questions'); // Switch to questions view\n\n        try {\n            const res = await fetch(`/api/admin/quiz/history?level=${selectedLevel}&date=${date}`);\n            const data = await res.json();\n            if (res.ok) {\n                setQuestions(data.questions);\n            } else {\n                toast.error(\"Failed to load past quiz\");\n            }\n        } catch (error) {\n            toast.error(\"Error connecting to server\");\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const closeModals = () => {\n        setViewMode('none');\n        setQuestions([]);\n        setHistoryList([]);\n    };\n\n    return (\n        <div className=\"space-y-6\">\n            <div className=\"flex justify-between items-center\">\n                <h1 className=\"text-3xl font-bold text-slate-900\">Quiz Management</h1>\n                <button className=\"px-5 py-2.5 bg-blue-600 text-white font-bold rounded-xl shadow-lg shadow-blue-200 hover:bg-blue-700 transition-all\">\n                    âœ¨ Generate New Quiz (AI)\n                </button>\n            </div>\n\n            <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n                {levels.map((level, i) => (\n                    <div key={i} className=\"bg-white border border-slate-200 rounded-2xl p-6 shadow-sm hover:shadow-md transition-shadow\">\n                        <div className=\"flex justify-between items-start mb-4\">\n                            <h3 className=\"text-xl font-bold text-slate-800\">{level}</h3>\n                            <span className=\"bg-green-100 text-green-700 px-2 py-1 rounded text-xs font-bold\">Today's Quiz Active</span>\n                        </div>\n                        <p className=\"text-slate-500 text-sm mb-6\">Topic: General Science</p>\n\n                        <div className=\"space-y-3\">\n                            <div className=\"flex justify-between text-sm\">\n                                <span className=\"text-slate-500\">Total Questions</span>\n                                <span className=\"font-bold\">25</span>\n                            </div>\n                            <div className=\"flex justify-between text-sm\">\n                                <span className=\"text-slate-500\">Participants</span>\n                                <span className=\"font-bold\">--</span>\n                            </div>\n                        </div>\n\n                        <div className=\"mt-6 pt-4 border-t border-slate-100 flex gap-2\">\n                            <button\n                                onClick={() => handleViewQuestions(i)}\n                                className=\"flex-1 py-2 text-blue-600 font-bold bg-blue-50 rounded-lg hover:bg-blue-100 transition-colors text-sm\"\n                            >\n                                View Questions\n                            </button>\n                            <button\n                                onClick={() => handleViewHistory(i)}\n                                className=\"flex-1 py-2 text-slate-600 font-bold bg-slate-50 rounded-lg hover:bg-slate-100 transition-colors text-sm\"\n                            >\n                                History\n                            </button>\n                        </div>\n                    </div>\n                ))}\n            </div>\n\n            <div className=\"bg-blue-50 border border-blue-100 rounded-xl p-6 flex items-center gap-4\">\n                <div className=\"text-3xl\">ðŸ¤–</div>\n                <div>\n                    <h4 className=\"font-bold text-blue-900\">AI Auto-Scheduler Active</h4>\n                    <p className=\"text-blue-700 text-sm\">Next batch of quizzes will be generated automatically at 00:00 AM.</p>\n                </div>\n            </div>\n\n            {/* Questions Modal */}\n            {viewMode === 'questions' && (\n                <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 backdrop-blur-sm\">\n                    <div className=\"bg-white rounded-2xl w-full max-w-3xl max-h-[90vh] shadow-2xl overflow-hidden flex flex-col animate-in fade-in zoom-in duration-200\">\n                        <div className=\"bg-slate-50 px-6 py-4 border-b border-slate-200 flex justify-between items-center shrink-0\">\n                            <div>\n                                <h3 className=\"font-bold text-xl text-slate-900\">Quiz Content</h3>\n                                <p className=\"text-sm text-slate-500 font-medium\">{levels[selectedLevel - 1]} â€¢ {selectedDate}</p>\n                            </div>\n                            <button onClick={closeModals} className=\"text-slate-400 hover:text-slate-600 hover:bg-slate-200 p-2 rounded-lg transition-colors\">\n                                <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" /></svg>\n                            </button>\n                        </div>\n\n                        <div className=\"overflow-y-auto p-6 space-y-6\">\n                            {loading ? (\n                                <div className=\"py-20 text-center text-slate-500 animate-pulse\">Loading questions...</div>\n                            ) : questions.length === 0 ? (\n                                <div className=\"py-20 text-center text-slate-500 bg-slate-50 rounded-xl border border-dashed border-slate-300\">\n                                    No questions found for this quiz.\n                                </div>\n                            ) : (\n                                questions.map((q, idx) => (\n                                    <div key={q._id} className=\"bg-white border border-slate-200 rounded-xl p-5 shadow-sm\">\n                                        <div className=\"flex gap-3 mb-3\">\n                                            <span className=\"bg-blue-100 text-blue-700 w-8 h-8 flex items-center justify-center rounded-lg font-bold shrink-0 text-sm\">\n                                                {idx + 1}\n                                            </span>\n                                            <h4 className=\"font-bold text-slate-800 text-lg leading-tight pt-0.5\">{q.text}</h4>\n                                        </div>\n\n                                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3 pl-11\">\n                                            {q.options.map((opt, optIdx) => (\n                                                <div\n                                                    key={optIdx}\n                                                    className={`px-4 py-3 rounded-lg text-sm font-medium border transition-colors flex items-center justify-between\n                                                        ${optIdx === q.answerIndex\n                                                            ? 'bg-green-50 border-green-200 text-green-800'\n                                                            : 'bg-slate-50 border-slate-100 text-slate-600'\n                                                        }`}\n                                                >\n                                                    {opt}\n                                                    {optIdx === q.answerIndex && (\n                                                        <span className=\"text-green-600\">âœ“</span>\n                                                    )}\n                                                </div>\n                                            ))}\n                                        </div>\n                                        <div className=\"pl-11 mt-2 text-xs text-slate-400 font-medium uppercase tracking-wide\">\n                                            Category: {q.category}\n                                        </div>\n                                    </div>\n                                ))\n                            )}\n                        </div>\n                    </div>\n                </div>\n            )}\n\n            {/* History Modal */}\n            {viewMode === 'history' && (\n                <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 backdrop-blur-sm\">\n                    <div className=\"bg-white rounded-2xl w-full max-w-lg max-h-[80vh] shadow-2xl overflow-hidden flex flex-col animate-in fade-in zoom-in duration-200\">\n                        <div className=\"bg-slate-50 px-6 py-4 border-b border-slate-200 flex justify-between items-center shrink-0\">\n                            <div>\n                                <h3 className=\"font-bold text-xl text-slate-900\">Quiz History</h3>\n                                <p className=\"text-sm text-slate-500 font-medium\">{levels[selectedLevel - 1]}</p>\n                            </div>\n                            <button onClick={closeModals} className=\"text-slate-400 hover:text-slate-600 hover:bg-slate-200 p-2 rounded-lg transition-colors\">\n                                <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" /></svg>\n                            </button>\n                        </div>\n\n                        <div className=\"overflow-y-auto p-4\">\n                            {loading ? (\n                                <div className=\"py-12 text-center text-slate-500 animate-pulse\">Loading history...</div>\n                            ) : historyList.length === 0 ? (\n                                <div className=\"py-12 text-center text-slate-500 bg-slate-50 rounded-xl border border-dashed border-slate-300\">\n                                    No history available.\n                                </div>\n                            ) : (\n                                <div className=\"space-y-2\">\n                                    {historyList.map((entry) => (\n                                        <button\n                                            key={entry._id}\n                                            onClick={() => handleHistoryDateClick(entry._id)}\n                                            className=\"w-full flex items-center justify-between p-4 bg-white border border-slate-200 rounded-xl hover:bg-blue-50 hover:border-blue-200 transition-all group text-left\"\n                                        >\n                                            <div className=\"flex items-center gap-3\">\n                                                <div className=\"w-10 h-10 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center font-bold\">\n                                                    ðŸ“…\n                                                </div>\n                                                <div>\n                                                    <div className=\"font-bold text-slate-900 group-hover:text-blue-700 transition-colors\">\n                                                        {entry._id}\n                                                    </div>\n                                                    <div className=\"text-xs text-slate-500 font-medium\">\n                                                        {entry.count} Questions Generated\n                                                    </div>\n                                                </div>\n                                            </div>\n                                            <span className=\"text-slate-300 group-hover:text-blue-500 transition-colors\">â†’</span>\n                                        </button>\n                                    ))}\n                                </div>\n                            )}\n                        </div>\n                    </div>\n                </div>\n            )}\n        </div>\n    );\n}\n"],"names":[],"mappings":"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"}