(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,91484,e=>{"use strict";var t=e.i(43476),s=e.i(71645),l=e.i(46696);function a(){let[e,a]=(0,s.useState)("EQ"),[r,o]=(0,s.useState)("Vajra International"),[d,n]=(0,s.useState)({name:"",idNo:"",age:"",class:"",password:""}),[i,c]=(0,s.useState)(null),[x,u]=(0,s.useState)(!1),[h,p]=(0,s.useState)([]),[m,b]=(0,s.useState)(!0),[f,g]=(0,s.useState)(!0),[j,N]=(0,s.useState)(new Set);(0,s.useEffect)(()=>{(async()=>{let e=localStorage.getItem("faculty_session"),t=e?JSON.parse(e):null;if(t)try{let e=await fetch(`/api/faculty/profile?facultyId=${t.id}`),s=await e.json();if(!e.ok||!s.isProfileActive){b(!1),g(!1);return}a(s.uniqueId),o(s.schoolName);let l=await fetch(`/api/students?facultyId=${t.id}`),r=await l.json();Array.isArray(r)&&p(r)}catch(e){console.error("Fetch error",e)}g(!1)})()},[]);let v=async s=>{if(s.preventDefault(),!d.name.trim())return void l.toast.error("Student Name is required");if(!d.age||5>parseInt(d.age)||parseInt(d.age)>25)return void l.toast.error("Please enter a valid age (5-25)");if(!d.class)return void l.toast.error("Please select a class");let a=localStorage.getItem("faculty_session"),o=a?JSON.parse(a):null;try{if(i){d.idNo.toUpperCase();let e=await fetch("/api/students",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:i,...d})}),t=await e.json();if(!e.ok)return void l.toast.error(t.error||"Update failed");p(h.map(e=>e._id===i?t.student:e)),c(null),l.toast.success("Student updated successfully!")}else{let s=await fetch("/api/students",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...d,school:r,facultyId:o?.id,prefix:e})}),a=await s.json();if(!s.ok)return void l.toast.error(a.error||"Enrollment failed");p([a.student,...h]),l.toast.success((0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("p",{className:"font-bold text-base",children:"Student Enrolled!"}),(0,t.jsxs)("div",{className:"bg-slate-100 p-2 rounded text-slate-800 font-mono text-sm",children:[(0,t.jsxs)("div",{children:["ID: ",(0,t.jsx)("span",{className:"font-bold",children:a.credentials.idNo})]}),(0,t.jsxs)("div",{children:["Pass: ",(0,t.jsx)("span",{className:"font-bold",children:a.credentials.password})]})]}),(0,t.jsx)("p",{className:"text-xs",children:"Credentials copied to clipboard"})]}),{duration:1e4}),navigator.clipboard.writeText(`EduQuiz Login
ID: ${a.credentials.idNo}
Password: ${a.credentials.password}`)}n({name:"",idNo:"",age:"",class:"",password:""})}catch(e){l.toast.error("Something went wrong")}},w=async e=>{if(confirm("Are you sure you want to delete this student?"))try{(await fetch(`/api/students?id=${e}`,{method:"DELETE"})).ok?(p(h.filter(t=>t._id!==e)),l.toast.success("Student deleted successfully")):l.toast.error("Failed to delete")}catch(e){l.toast.error("Error deleting student")}};return f?(0,t.jsx)("div",{className:"p-10 text-center font-bold text-slate-400",children:"Loading activation status..."}):m?(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)("div",{className:"bg-white p-8 rounded-3xl border border-slate-100 shadow-sm",children:[(0,t.jsxs)("h2",{className:"text-2xl font-bold text-slate-900 mb-6 flex items-center gap-2",children:[(0,t.jsx)("span",{children:i?"âœï¸":"ðŸ“"})," ",i?"Edit Student Details":"Enroll New Student"]}),(0,t.jsxs)("form",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",onSubmit:v,children:[(0,t.jsxs)("div",{className:"col-span-1 md:col-span-3 bg-blue-50 border border-blue-100 p-4 rounded-xl flex items-start gap-3",children:[(0,t.jsx)("div",{className:"text-2xl",children:"â„¹ï¸"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-bold text-blue-900 text-sm",children:"Automatic Enrollment"}),(0,t.jsxs)("p",{className:"text-blue-700 text-xs mt-1",children:["Student ID and Password will be ",(0,t.jsx)("strong",{children:"automatically generated"})," upon enrollment. You will be able to copy the credentials immediately after registration."]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-1",children:"Student Name"}),(0,t.jsx)("input",{type:"text",required:!0,value:d.name,onChange:e=>n({...d,name:e.target.value}),className:"w-full px-4 py-2 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"e.g. Rahul Sharma"})]}),i?(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-1",children:"ID No."}),(0,t.jsx)("input",{type:"text",disabled:!0,value:d.idNo,className:"w-full px-4 py-2 bg-slate-100 border border-slate-200 rounded-xl text-slate-500 font-mono cursor-not-allowed"})]}):(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-1",children:"ID No."}),(0,t.jsxs)("div",{className:"w-full px-4 py-2 bg-slate-100 border border-slate-200 rounded-xl text-slate-400 italic",children:["Auto-generated (",e,"-YYYY-XXX)"]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-1",children:"Age"}),(0,t.jsx)("input",{type:"number",required:!0,value:d.age,onChange:e=>n({...d,age:e.target.value}),className:"w-full px-4 py-2 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"15"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-1",children:"Class"}),(0,t.jsxs)("select",{required:!0,value:d.class,onChange:e=>n({...d,class:e.target.value}),className:"w-full px-4 py-2 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none font-bold text-slate-700",children:[(0,t.jsx)("option",{value:"",children:"Select Class"}),(0,t.jsx)("option",{children:"4th"}),(0,t.jsx)("option",{children:"5th"}),(0,t.jsx)("option",{children:"6th"}),(0,t.jsx)("option",{children:"7th"}),(0,t.jsx)("option",{children:"8th"}),(0,t.jsx)("option",{children:"9th"}),(0,t.jsx)("option",{children:"10th"})]})]})]}),i&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-1",children:"Reset Password (Optional)"}),(0,t.jsxs)("div",{className:"relative group",children:[(0,t.jsx)("input",{type:x?"text":"password",value:d.password,onChange:e=>n({...d,password:e.target.value}),className:"w-full px-4 py-2.5 bg-white border-2 border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none pr-12 transition-all font-mono",placeholder:"Enter new password",autoComplete:"new-password"}),(0,t.jsx)("button",{type:"button",onClick:()=>u(!x),className:"absolute right-2 top-1/2 -translate-y-1/2 p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all z-10",title:x?"Hide":"Show",children:x?(0,t.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l18 18"})}):(0,t.jsxs)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),(0,t.jsxs)("div",{className:"lg:col-span-3 flex justify-end gap-3",children:[i&&(0,t.jsx)("button",{type:"button",onClick:()=>{c(null),n({name:"",idNo:"",age:"",class:"",password:""})},className:"px-6 py-3 bg-slate-100 text-slate-600 font-bold rounded-xl hover:bg-slate-200 transition-all",children:"Cancel"}),(0,t.jsx)("button",{type:"submit",className:"px-8 py-3 bg-blue-700 text-white font-bold rounded-xl hover:bg-blue-800 transition-all shadow-lg hover:shadow-blue-200 active:scale-[0.98]",children:i?"Update Student":"Generate & Register"})]})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-3xl border border-slate-100 shadow-sm overflow-hidden",children:[(0,t.jsxs)("div",{className:"p-8 border-b",children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-slate-900",children:"Enrolled Students"}),(0,t.jsx)("p",{className:"text-slate-500 text-sm mt-1",children:"Manage and track your enrolled students for the current session."})]}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full text-left",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"bg-slate-50",children:[(0,t.jsx)("th",{className:"px-8 py-4 text-xs font-bold text-slate-500 uppercase tracking-widest",children:"Name"}),(0,t.jsx)("th",{className:"px-8 py-4 text-xs font-bold text-slate-500 uppercase tracking-widest",children:"School"}),(0,t.jsx)("th",{className:"px-8 py-4 text-xs font-bold text-slate-500 uppercase tracking-widest",children:"Class"}),(0,t.jsx)("th",{className:"px-8 py-4 text-xs font-bold text-slate-500 uppercase tracking-widest",children:"ID"}),(0,t.jsx)("th",{className:"px-8 py-4 text-xs font-bold text-slate-500 uppercase tracking-widest",children:"Password"}),(0,t.jsx)("th",{className:"px-8 py-4 text-xs font-bold text-slate-500 uppercase tracking-widest",children:"Status"}),(0,t.jsx)("th",{className:"px-8 py-4 text-xs font-bold text-slate-500 uppercase tracking-widest text-right",children:"Actions"})]})}),(0,t.jsx)("tbody",{className:"divide-y divide-slate-100",children:h.map((s,l)=>(0,t.jsxs)("tr",{className:"hover:bg-slate-50/50 transition-colors group",children:[(0,t.jsx)("td",{className:"px-8 py-4",children:(0,t.jsx)("div",{className:"font-bold text-slate-800",children:s.name})}),(0,t.jsx)("td",{className:"px-8 py-4 text-slate-600",children:s.school}),(0,t.jsx)("td",{className:"px-8 py-4",children:(0,t.jsx)("span",{className:"px-3 py-1 bg-slate-100 text-slate-600 rounded-lg font-bold text-xs",children:s.class})}),(0,t.jsx)("td",{className:"px-8 py-4 font-mono text-sm text-blue-600 font-bold",children:s.idNo.includes("-")?s.idNo:`${e}-${s.idNo}`}),(0,t.jsx)("td",{className:"px-8 py-4 font-mono text-sm text-slate-600 font-bold",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("span",{children:j.has(s._id)?s.displayPassword||"******** (Protected)":"â€¢â€¢â€¢â€¢â€¢â€¢"}),(0,t.jsx)("button",{onClick:()=>{var e;let t;return e=s._id,void((t=new Set(j)).has(e)?t.delete(e):t.add(e),N(t))},className:`p-1.5 rounded-lg transition-all border ${j.has(s._id)?"bg-blue-600 text-white border-blue-700":"bg-slate-50 text-slate-500 hover:text-blue-700 hover:bg-blue-50 border-slate-200"}`,title:j.has(s._id)?"Hide Password":"Show Password",children:j.has(s._id)?(0,t.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l18 18"})}):(0,t.jsxs)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})}),(0,t.jsx)("td",{className:"px-8 py-4",children:(0,t.jsx)("span",{className:`px-3 py-1 text-[10px] font-black uppercase rounded-full ${"Active"===s.status?"bg-green-100 text-green-700":"bg-amber-100 text-amber-700"}`,children:s.status})}),(0,t.jsxs)("td",{className:"px-8 py-4 text-right flex justify-end gap-2",children:[(0,t.jsx)("button",{onClick:()=>!s.hasAttempted&&void(c(s._id),n({name:s.name,idNo:s.idNo,age:s.age||"",class:s.class,password:""}),window.scrollTo({top:0,behavior:"smooth"})),disabled:s.hasAttempted,className:`p-2 rounded-lg transition-colors ${s.hasAttempted?"text-slate-300 cursor-not-allowed":"text-blue-600 hover:bg-blue-50"}`,title:s.hasAttempted?"Cannot edit: Student has already started/finished the exam for today. This prevents results from being corrupted.":"Edit Details",children:"âœï¸"}),(0,t.jsx)("button",{onClick:()=>w(s._id),className:"p-2 text-red-500 hover:bg-red-50 rounded-lg transition-colors",title:"Delete",children:"ðŸ—‘ï¸"})]})]},s.idNo+l))})]})})]})]}):(0,t.jsxs)("div",{className:"bg-white p-12 rounded-[40px] border-2 border-dashed border-slate-200 text-center",children:[(0,t.jsx)("div",{className:"text-6xl mb-6",children:"ðŸ”’"}),(0,t.jsx)("h2",{className:"text-2xl font-black text-slate-800 mb-2",children:"School Profile Not Activated"}),(0,t.jsx)("p",{className:"text-slate-500 mb-8 font-medium",children:"Please configure your School Name and Unique ID in the Profile section before you can enroll students."}),(0,t.jsx)("a",{href:"/faculty/dashboard/profile",className:"px-8 py-3 bg-blue-700 text-white font-black rounded-xl hover:bg-blue-800 transition-all",children:"Go to Profile Setup"})]})}e.s(["default",()=>a])}]);